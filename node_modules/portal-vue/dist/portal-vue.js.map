{"version":3,"file":"portal-vue.js","sources":["../src/utils.js","../src/components/wormhole.js","../node_modules/babel-helper-vue-jsx-merge-props/index.js","../src/components/portal-target.js","../src/components/portal.js","../src/index.js"],"sourcesContent":["export function extractAttributes(el) {\n  const map = el.hasAttributes() ? el.attributes : []\n  const attrs = {}\n  for (let i = 0; i < map.length; i++) {\n    const attr = map[i]\n    if (attr.value) {\n      attrs[attr.name] = attr.value === '' ? true : attr.value\n    }\n  }\n  let klass, style\n  if (attrs.class) {\n    klass = attrs.class\n    delete attrs.class\n  }\n  if (attrs.style) {\n    style = attrs.style\n    delete attrs.style\n  }\n  const data = {\n    attrs,\n    class: klass,\n    style,\n  }\n  return data\n}\n\nexport function freeze(item) {\n  if (Array.isArray(item) || typeof item === 'object') {\n    return Object.freeze(item)\n  }\n  return item\n}\n\nexport function combinePassengers(transports, slotProps = {}) {\n  return transports.reduce((passengers, transport) => {\n    let newPassengers = transport.passengers[0]\n    newPassengers =\n      typeof newPassengers === 'function'\n        ? newPassengers(slotProps)\n        : transport.passengers\n    return passengers.concat(newPassengers)\n  }, [])\n}\n\nexport function stableSort(array, compareFn) {\n  return array\n    .map((v, idx) => [idx, v])\n    .sort(function (a,b) { return this(a[1], b[1]) || a[0] - b[0] }.bind(compareFn))\n    .map(c => c[1])\n}\n","import Vue from 'vue'\nimport { combinePassengers, freeze, stableSort } from '../utils'\nconst transports = {}\n\nexport { transports }\n\nexport const Wormhole = Vue.extend({\n  data: () => ({ transports }),\n  methods: {\n    open(transport) {\n      const { to, from, passengers } = transport\n      if (!to || !from || !passengers) return\n\n      transport.passengers = freeze(passengers)\n      const keys = Object.keys(this.transports)\n      if (keys.indexOf(to) === -1) {\n        Vue.set(this.transports, to, [])\n      }\n\n      const currentIndex = this.getTransportIndex(transport)\n      // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n      const newTransports = this.transports[to].slice(0)\n      if (currentIndex === -1) {\n        newTransports.push(transport)\n      } else {\n        newTransports[currentIndex] = transport\n      }\n      this.transports[to] = stableSort(newTransports, function(a, b) {\n        return a.order - b.order\n      })\n    },\n\n    close(transport, force = false) {\n      const { to, from } = transport\n      if (!to || !from) return\n      if (!this.transports[to]) {\n        return\n      }\n\n      if (force) {\n        this.transports[to] = []\n      } else {\n        const index = this.getTransportIndex(transport)\n        if (index >= 0) {\n          // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n          const newTransports = this.transports[to].slice(0)\n          newTransports.splice(index, 1)\n          this.transports[to] = newTransports\n        }\n      }\n    },\n\n    hasTarget(to) {\n      return this.transports.hasOwnProperty(to)\n    },\n\n    hasContentFor(to) {\n      if (!this.transports[to]) {\n        return false\n      }\n      return this.getContentFor(to).length > 0\n    },\n\n    getSourceFor(to) {\n      return this.transports[to] && this.transports[to][0].from\n    },\n\n    getContentFor(to) {\n      const transports = this.transports[to]\n      if (!transports) {\n        return undefined\n      }\n      return combinePassengers(transports)\n    },\n\n    getTransportIndex({ to, from }) {\n      for (const i in this.transports[to]) {\n        if (this.transports[to][i].from === from) {\n          return i\n        }\n      }\n      return -1\n    },\n  },\n})\n\nconst wormhole = new Wormhole(transports)\nexport default wormhole\n","var nestRE = /^(attrs|props|on|nativeOn|class|style|hook)$/\n\nmodule.exports = function mergeJSXProps (objs) {\n  return objs.reduce(function (a, b) {\n    var aa, bb, key, nestedKey, temp\n    for (key in b) {\n      aa = a[key]\n      bb = b[key]\n      if (aa && nestRE.test(key)) {\n        // normalize class\n        if (key === 'class') {\n          if (typeof aa === 'string') {\n            temp = aa\n            a[key] = aa = {}\n            aa[temp] = true\n          }\n          if (typeof bb === 'string') {\n            temp = bb\n            b[key] = bb = {}\n            bb[temp] = true\n          }\n        }\n        if (key === 'on' || key === 'nativeOn' || key === 'hook') {\n          // merge functions\n          for (nestedKey in bb) {\n            aa[nestedKey] = mergeFn(aa[nestedKey], bb[nestedKey])\n          }\n        } else if (Array.isArray(aa)) {\n          a[key] = aa.concat(bb)\n        } else if (Array.isArray(bb)) {\n          a[key] = [aa].concat(bb)\n        } else {\n          for (nestedKey in bb) {\n            aa[nestedKey] = bb[nestedKey]\n          }\n        }\n      } else {\n        a[key] = b[key]\n      }\n    }\n    return a\n  }, {})\n}\n\nfunction mergeFn (a, b) {\n  return function () {\n    a && a.apply(this, arguments)\n    b && b.apply(this, arguments)\n  }\n}\n","// import { transports } from './wormhole'\nimport { combinePassengers } from '../utils'\nimport wormhole from './wormhole'\n\nexport default {\n  abstract: false,\n  name: 'portalTarget',\n  props: {\n    attributes: { type: Object, default: () => ({}) },\n    multiple: { type: Boolean, default: false },\n    name: { type: String, required: true },\n    slim: { type: Boolean, default: false },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'div' },\n    transition: { type: [Boolean, String, Object], default: false },\n    transitionEvents: { type: Object, default: () => ({}) },\n  },\n  data() {\n    return {\n      transports: wormhole.transports,\n      firstRender: true,\n    }\n  },\n  created() {\n    if (!this.transports[this.name]) {\n      this.$set(this.transports, this.name, [])\n    }\n  },\n  mounted() {\n    this.unwatch = this.$watch('ownTransports', this.emitChange)\n    this.$nextTick(() => {\n      if (this.transition) {\n        // only when we have a transition, because it causes a re-render\n        this.firstRender = false\n      }\n    })\n    if (this.$options.abstract) {\n      this.$options.abstract = false\n    }\n  },\n  updated() {\n    if (this.$options.abstract) {\n      this.$options.abstract = false\n    }\n  },\n  beforeDestroy() {\n    this.unwatch()\n  },\n\n  computed: {\n    ownTransports() {\n      const transports = this.transports[this.name] || []\n      if (this.multiple) {\n        return transports\n      }\n      return transports.length === 0 ? [] : [transports[transports.length - 1]]\n    },\n    passengers() {\n      return combinePassengers(this.ownTransports, this.slotProps)\n    },\n    hasAttributes() {\n      return Object.keys(this.attributes).length > 0\n    },\n    withTransition() {\n      return !!this.transition\n    },\n    transitionData() {\n      const t = this.transition\n      const data = {}\n\n      // During first render, we render a dumb transition without any classes, events and a fake name\n      // We have to do this to emulate the normal behaviour of transitions without `appear`\n      // because in Portals, transitions can behave as if appear was defined under certain conditions.\n      if (\n        this.firstRender &&\n        (typeof this.transition === 'object' && !this.transition.appear)\n      ) {\n        data.props = { name: '__notranstition__portal-vue__' }\n        return data\n      }\n\n      if (typeof t === 'string') {\n        data.props = { name: t }\n      } else if (typeof t === 'object') {\n        data.props = t\n      }\n      if (this.renderSlim) {\n        data.props.tag = this.tag\n      }\n      data.on = this.transitionEvents\n\n      return data\n    },\n    transportedClasses() {\n      return this.ownTransports\n        .map(transport => transport.class)\n        .reduce((array, subarray) => array.concat(subarray), [])\n      //.filter((string, index, array) => array.indexOf(string) === index)\n    },\n  },\n\n  methods: {\n    emitChange(newTransports, oldTransports) {\n      if (this.multiple) {\n        this.$emit('change', [...newTransports], [...oldTransports])\n      } else {\n        const newTransport =\n          newTransports.length === 0 ? undefined : newTransports[0]\n        const oldTransport =\n          oldTransports.length === 0 ? undefined : oldTransports[0]\n        this.$emit('change', { ...newTransport }, { ...oldTransport })\n      }\n    },\n    // can't be a computed prop because it has to \"react\" to $slot changes.\n    children() {\n      return this.passengers.length !== 0\n        ? this.passengers\n        : this.$slots.default || []\n    },\n    noWrapper() {\n      const noWrapper = !this.hasAttributes && this.slim\n      if (noWrapper && this.children().length > 1) {\n        console.warn(\n          '[portal-vue]: PortalTarget with `slim` option received more than one child element.'\n        )\n      }\n      return noWrapper\n    },\n  },\n  render(h) {\n    this.$options.abstract = true\n    const noWrapper = this.noWrapper()\n    const children = this.children()\n    const TransitionType = noWrapper ? 'transition' : 'transition-group'\n    const Tag = this.tag\n\n    if (this.withTransition) {\n      return (\n        <TransitionType {...this.transitionData} class=\"vue-portal-target\">\n          {children}\n        </TransitionType>\n      )\n    }\n\n    return noWrapper ? (\n      children[0]\n    ) : (\n      <Tag\n        class={`vue-portal-target ${this.transportedClasses.join(' ')}`}\n        {...this.attributes}\n      >\n        {children}\n      </Tag>\n    )\n  },\n}\n","import Vue from 'vue'\nimport wormhole from './wormhole'\nimport Target from './portal-target'\nimport { extractAttributes } from '../utils'\n\nconst inBrowser = typeof window !== 'undefined'\n\nlet pid = 1\n\nexport default {\n  abstract: false,\n  name: 'portal',\n  props: {\n    /* global HTMLElement */\n    disabled: { type: Boolean, default: false },\n    name: { type: String, default: () => String(pid++) },\n    order: { type: Number, default: 0 },\n    slim: { type: Boolean, default: false },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: [String], default: 'DIV' },\n    targetEl: { type: inBrowser ? [String, HTMLElement] : String },\n    targetClass: { type: String },\n    to: {\n      type: String,\n      default: () => String(Math.round(Math.random() * 10000000)),\n    },\n  },\n\n  mounted() {\n    if (this.targetEl) {\n      this.mountToTarget()\n    }\n    if (!this.disabled) {\n      this.sendUpdate()\n    }\n    // Reset hack to make child components skip the portal when defining their $parent\n    // was set to true during render when we render something locally.\n    if (this.$options.abstract) {\n      this.$options.abstract = false\n    }\n  },\n\n  updated() {\n    if (this.disabled) {\n      this.clear()\n    } else {\n      this.sendUpdate()\n    }\n    // Reset hack to make child components skip the portal when defining their $parent\n    // was set to true during render when we render something locally.\n    if (this.$options.abstract) {\n      this.$options.abstract = false\n    }\n  },\n\n  beforeDestroy() {\n    this.clear()\n    if (this.mountedComp) {\n      this.mountedComp.$destroy()\n    }\n  },\n  watch: {\n    to(newValue, oldValue) {\n      oldValue && oldValue !== newValue && this.clear(oldValue)\n      this.sendUpdate()\n    },\n    targetEl(newValue, oldValue) {\n      if (newValue) {\n        this.mountToTarget()\n      }\n    },\n  },\n\n  methods: {\n    normalizedSlots() {\n      return this.$scopedSlots.default\n        ? [this.$scopedSlots.default]\n        : this.$slots.default\n    },\n    sendUpdate() {\n      const slotContent = this.normalizedSlots()\n\n      if (slotContent) {\n        wormhole.open({\n          from: this.name,\n          to: this.to,\n          passengers: [...slotContent],\n          class: this.targetClass && this.targetClass.split(' '),\n          order: this.order,\n        })\n      } else {\n        this.clear()\n      }\n    },\n\n    clear(target) {\n      wormhole.close({\n        from: this.name,\n        to: target || this.to,\n      })\n    },\n\n    mountToTarget() {\n      let el\n      const target = this.targetEl\n\n      if (typeof target === 'string') {\n        el = document.querySelector(target)\n      } else if (target instanceof HTMLElement) {\n        el = target\n      } else {\n        console.warn(\n          '[vue-portal]: value of targetEl must be of type String or HTMLElement'\n        )\n        return\n      }\n\n      if (el) {\n        const newTarget = new Vue({\n          ...Target,\n          parent: this,\n          propsData: {\n            name: this.to,\n            tag: el.tagName,\n            attributes: extractAttributes(el),\n          },\n        })\n        newTarget.$mount(el)\n        this.mountedComp = newTarget\n      } else {\n        console.warn(\n          '[vue-portal]: The specified targetEl ' + target + ' was not found'\n        )\n      }\n    },\n    normalizeChildren(children) {\n      return typeof children === 'function'\n        ? children(this.slotProps)\n        : children\n    },\n  },\n\n  render(h) {\n    const children = this.$slots.default || this.$scopedSlots.default || []\n    const Tag = this.tag\n    if (children.length && this.disabled) {\n      // hack to make child components skip the portal when defining their $parent\n      this.$options.abstract = true\n      return children.length <= 1 && this.slim ? (\n        children[0]\n      ) : (\n        <Tag>{this.normalizeChildren(children)}</Tag>\n      )\n    } else {\n      return (\n        <Tag\n          class={'v-portal'}\n          style={'display: none'}\n          key={'v-portal-placeholder'}\n        />\n      )\n      // h(this.tag, { class: { 'v-portal': true }, style: { display: 'none' }, key: 'v-portal-placeholder' })\n    }\n  },\n}\n","import Portal from './components/portal.js'\nimport PortalTarget from './components/portal-target.js'\nimport Wormhole from './components/wormhole.js'\n\nfunction install(Vue, opts = {}) {\n  Vue.component(opts.portalName || 'Portal', Portal)\n  Vue.component(opts.portalTargetName || 'PortalTarget', PortalTarget)\n}\nif (typeof window !== 'undefined' && window.Vue) {\n  window.Vue.use({ install: install })\n}\n\nexport default {\n  install,\n  Portal,\n  PortalTarget,\n  Wormhole,\n}\n"],"names":["extractAttributes","el","map","hasAttributes","attributes","attrs","i","length","attr","value","name","klass","style","class","data","freeze","item","Array","isArray","Object","combinePassengers","transports","slotProps","reduce","passengers","transport","newPassengers","concat","stableSort","array","compareFn","v","idx","sort","a","b","bind","c","Wormhole","Vue","extend","to","from","keys","indexOf","set","currentIndex","getTransportIndex","newTransports","slice","push","order","force","index","splice","hasOwnProperty","getContentFor","undefined","wormhole","type","default","Boolean","String","required","$set","unwatch","$watch","emitChange","$nextTick","transition","firstRender","$options","abstract","multiple","ownTransports","t","babelHelpers.typeof","appear","props","renderSlim","tag","on","transitionEvents","subarray","oldTransports","$emit","newTransport","oldTransport","$slots","noWrapper","slim","children","warn","h","TransitionType","Tag","withTransition","transitionData","transportedClasses","join","inBrowser","window","pid","Number","HTMLElement","Math","round","random","targetEl","mountToTarget","disabled","sendUpdate","clear","mountedComp","$destroy","newValue","oldValue","$scopedSlots","slotContent","normalizedSlots","open","targetClass","split","target","close","document","querySelector","newTarget","Target","tagName","$mount","normalizeChildren","install","opts","component","portalName","Portal","portalTargetName","PortalTarget","use"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,SAASA,iBAAT,CAA2BC,EAA3B,EAA+B;MAC9BC,MAAMD,GAAGE,aAAH,KAAqBF,GAAGG,UAAxB,GAAqC,EAAjD;MACMC,QAAQ,EAAd;OACK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,IAAIK,MAAxB,EAAgCD,GAAhC,EAAqC;QAC7BE,OAAON,IAAII,CAAJ,CAAb;QACIE,KAAKC,KAAT,EAAgB;YACRD,KAAKE,IAAX,IAAmBF,KAAKC,KAAL,KAAe,EAAf,GAAoB,IAApB,GAA2BD,KAAKC,KAAnD;;;MAGAE,cAAJ;MAAWC,cAAX;MACIP,MAAMQ,KAAV,EAAiB;YACPR,MAAMQ,KAAd;WACOR,MAAMQ,KAAb;;MAEER,MAAMO,KAAV,EAAiB;YACPP,MAAMO,KAAd;WACOP,MAAMO,KAAb;;MAEIE,OAAO;gBAAA;WAEJH,KAFI;;GAAb;SAKOG,IAAP;;;AAGF,AAAO,SAASC,MAAT,CAAgBC,IAAhB,EAAsB;MACvBC,MAAMC,OAAN,CAAcF,IAAd,KAAuB,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAA3C,EAAqD;WAC5CG,OAAOJ,MAAP,CAAcC,IAAd,CAAP;;SAEKA,IAAP;;;AAGF,AAAO,SAASI,iBAAT,CAA2BC,UAA3B,EAAuD;MAAhBC,SAAgB,uEAAJ,EAAI;;SACrDD,WAAWE,MAAX,CAAkB,UAACC,UAAD,EAAaC,SAAb,EAA2B;QAC9CC,gBAAgBD,UAAUD,UAAV,CAAqB,CAArB,CAApB;oBAEE,OAAOE,aAAP,KAAyB,UAAzB,GACIA,cAAcJ,SAAd,CADJ,GAEIG,UAAUD,UAHhB;WAIOA,WAAWG,MAAX,CAAkBD,aAAlB,CAAP;GANK,EAOJ,EAPI,CAAP;;;AAUF,AAAO,SAASE,UAAT,CAAoBC,KAApB,EAA2BC,SAA3B,EAAsC;SACpCD,MACJ3B,GADI,CACA,UAAC6B,CAAD,EAAIC,GAAJ;WAAY,CAACA,GAAD,EAAMD,CAAN,CAAZ;GADA,EAEJE,IAFI,CAEC,UAAUC,CAAV,EAAYC,CAAZ,EAAe;WAAS,KAAKD,EAAE,CAAF,CAAL,EAAWC,EAAE,CAAF,CAAX,KAAoBD,EAAE,CAAF,IAAOC,EAAE,CAAF,CAAlC;GAAjB,CAA0DC,IAA1D,CAA+DN,SAA/D,CAFD,EAGJ5B,GAHI,CAGA;WAAKmC,EAAE,CAAF,CAAL;GAHA,CAAP;;;AC3CF,IAAMhB,aAAa,EAAnB;;AAEA,AAEO,IAAMiB,WAAWC,IAAIC,MAAJ,CAAW;QAC3B;WAAO,EAAEnB,sBAAF,EAAP;GAD2B;WAExB;QAAA,gBACFI,SADE,EACS;UACNgB,EADM,GACmBhB,SADnB,CACNgB,EADM;UACFC,IADE,GACmBjB,SADnB,CACFiB,IADE;UACIlB,UADJ,GACmBC,SADnB,CACID,UADJ;;UAEV,CAACiB,EAAD,IAAO,CAACC,IAAR,IAAgB,CAAClB,UAArB,EAAiC;;gBAEvBA,UAAV,GAAuBT,OAAOS,UAAP,CAAvB;UACMmB,OAAOxB,OAAOwB,IAAP,CAAY,KAAKtB,UAAjB,CAAb;UACIsB,KAAKC,OAAL,CAAaH,EAAb,MAAqB,CAAC,CAA1B,EAA6B;YACvBI,GAAJ,CAAQ,KAAKxB,UAAb,EAAyBoB,EAAzB,EAA6B,EAA7B;;;UAGIK,eAAe,KAAKC,iBAAL,CAAuBtB,SAAvB,CAArB;;UAEMuB,gBAAgB,KAAK3B,UAAL,CAAgBoB,EAAhB,EAAoBQ,KAApB,CAA0B,CAA1B,CAAtB;UACIH,iBAAiB,CAAC,CAAtB,EAAyB;sBACTI,IAAd,CAAmBzB,SAAnB;OADF,MAEO;sBACSqB,YAAd,IAA8BrB,SAA9B;;WAEGJ,UAAL,CAAgBoB,EAAhB,IAAsBb,WAAWoB,aAAX,EAA0B,UAASd,CAAT,EAAYC,CAAZ,EAAe;eACtDD,EAAEiB,KAAF,GAAUhB,EAAEgB,KAAnB;OADoB,CAAtB;KAnBK;SAAA,iBAwBD1B,SAxBC,EAwByB;UAAf2B,KAAe,uEAAP,KAAO;UACtBX,EADsB,GACThB,SADS,CACtBgB,EADsB;UAClBC,IADkB,GACTjB,SADS,CAClBiB,IADkB;;UAE1B,CAACD,EAAD,IAAO,CAACC,IAAZ,EAAkB;UACd,CAAC,KAAKrB,UAAL,CAAgBoB,EAAhB,CAAL,EAA0B;;;;UAItBW,KAAJ,EAAW;aACJ/B,UAAL,CAAgBoB,EAAhB,IAAsB,EAAtB;OADF,MAEO;YACCY,QAAQ,KAAKN,iBAAL,CAAuBtB,SAAvB,CAAd;YACI4B,SAAS,CAAb,EAAgB;;cAERL,gBAAgB,KAAK3B,UAAL,CAAgBoB,EAAhB,EAAoBQ,KAApB,CAA0B,CAA1B,CAAtB;wBACcK,MAAd,CAAqBD,KAArB,EAA4B,CAA5B;eACKhC,UAAL,CAAgBoB,EAAhB,IAAsBO,aAAtB;;;KAvCC;aAAA,qBA4CGP,EA5CH,EA4CO;aACL,KAAKpB,UAAL,CAAgBkC,cAAhB,CAA+Bd,EAA/B,CAAP;KA7CK;iBAAA,yBAgDOA,EAhDP,EAgDW;UACZ,CAAC,KAAKpB,UAAL,CAAgBoB,EAAhB,CAAL,EAA0B;eACjB,KAAP;;aAEK,KAAKe,aAAL,CAAmBf,EAAnB,EAAuBlC,MAAvB,GAAgC,CAAvC;KApDK;gBAAA,wBAuDMkC,EAvDN,EAuDU;aACR,KAAKpB,UAAL,CAAgBoB,EAAhB,KAAuB,KAAKpB,UAAL,CAAgBoB,EAAhB,EAAoB,CAApB,EAAuBC,IAArD;KAxDK;iBAAA,yBA2DOD,EA3DP,EA2DW;UACVpB,aAAa,KAAKA,UAAL,CAAgBoB,EAAhB,CAAnB;UACI,CAACpB,UAAL,EAAiB;eACRoC,SAAP;;aAEKrC,kBAAkBC,UAAlB,CAAP;KAhEK;qBAAA,mCAmEyB;UAAZoB,EAAY,QAAZA,EAAY;UAARC,IAAQ,QAARA,IAAQ;;WACzB,IAAMpC,CAAX,IAAgB,KAAKe,UAAL,CAAgBoB,EAAhB,CAAhB,EAAqC;YAC/B,KAAKpB,UAAL,CAAgBoB,EAAhB,EAAoBnC,CAApB,EAAuBoC,IAAvB,KAAgCA,IAApC,EAA0C;iBACjCpC,CAAP;;;aAGG,CAAC,CAAR;;;CA3EkB,CAAjB;;AAgFP,IAAMoD,WAAW,IAAIpB,QAAJ,CAAajB,UAAb,CAAjB;;ACtFA,IAAI,MAAM,GAAG,+CAA8C;;AAE3D,+BAAc,GAAG,SAAS,aAAa,EAAE,IAAI,EAAE;EAC7C,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;IACjC,IAAI,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,KAAI;IAChC,KAAK,GAAG,IAAI,CAAC,EAAE;MACb,EAAE,GAAG,CAAC,CAAC,GAAG,EAAC;MACX,EAAE,GAAG,CAAC,CAAC,GAAG,EAAC;MACX,IAAI,EAAE,IAAI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;;QAE1B,IAAI,GAAG,KAAK,OAAO,EAAE;UACnB,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YAC1B,IAAI,GAAG,GAAE;YACT,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAE;YAChB,EAAE,CAAC,IAAI,CAAC,GAAG,KAAI;WAChB;UACD,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YAC1B,IAAI,GAAG,GAAE;YACT,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAE;YAChB,EAAE,CAAC,IAAI,CAAC,GAAG,KAAI;WAChB;SACF;QACD,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,UAAU,IAAI,GAAG,KAAK,MAAM,EAAE;;UAExD,KAAK,SAAS,IAAI,EAAE,EAAE;YACpB,EAAE,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC,SAAS,CAAC,EAAC;WACtD;SACF,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;UAC5B,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,EAAE,EAAC;SACvB,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;UAC5B,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,EAAC;SACzB,MAAM;UACL,KAAK,SAAS,IAAI,EAAE,EAAE;YACpB,EAAE,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,SAAS,EAAC;WAC9B;SACF;OACF,MAAM;QACL,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,EAAC;OAChB;KACF;IACD,OAAO,CAAC;GACT,EAAE,EAAE,CAAC;EACP;;AAED,SAAS,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE;EACtB,OAAO,YAAY;IACjB,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,EAAC;IAC7B,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,EAAC;GAC9B;CACF;;ACjDD;AACA,AAGA,mBAAe;YACH,KADG;QAEP,cAFO;SAGN;gBACO,EAAEsC,MAAMxC,MAAR,EAAgByC,SAAS;eAAO,EAAP;OAAzB,EADP;cAEK,EAAED,MAAME,OAAR,EAAiBD,SAAS,KAA1B,EAFL;UAGC,EAAED,MAAMG,MAAR,EAAgBC,UAAU,IAA1B,EAHD;UAIC,EAAEJ,MAAME,OAAR,EAAiBD,SAAS,KAA1B,EAJD;eAKM,EAAED,MAAMxC,MAAR,EAAgByC,SAAS;eAAO,EAAP;OAAzB,EALN;SAMA,EAAED,MAAMG,MAAR,EAAgBF,SAAS,KAAzB,EANA;gBAOO,EAAED,MAAM,CAACE,OAAD,EAAUC,MAAV,EAAkB3C,MAAlB,CAAR,EAAmCyC,SAAS,KAA5C,EAPP;sBAQa,EAAED,MAAMxC,MAAR,EAAgByC,SAAS;eAAO,EAAP;OAAzB;GAXP;MAAA,kBAaN;WACE;kBACOF,SAASrC,UADhB;mBAEQ;KAFf;GAdW;SAAA,qBAmBH;QACJ,CAAC,KAAKA,UAAL,CAAgB,KAAKX,IAArB,CAAL,EAAiC;WAC1BsD,IAAL,CAAU,KAAK3C,UAAf,EAA2B,KAAKX,IAAhC,EAAsC,EAAtC;;GArBS;SAAA,qBAwBH;;;SACHuD,OAAL,GAAe,KAAKC,MAAL,CAAY,eAAZ,EAA6B,KAAKC,UAAlC,CAAf;SACKC,SAAL,CAAe,YAAM;UACf,MAAKC,UAAT,EAAqB;;cAEdC,WAAL,GAAmB,KAAnB;;KAHJ;QAMI,KAAKC,QAAL,CAAcC,QAAlB,EAA4B;WACrBD,QAAL,CAAcC,QAAd,GAAyB,KAAzB;;GAjCS;SAAA,qBAoCH;QACJ,KAAKD,QAAL,CAAcC,QAAlB,EAA4B;WACrBD,QAAL,CAAcC,QAAd,GAAyB,KAAzB;;GAtCS;eAAA,2BAyCG;SACTP,OAAL;GA1CW;;;YA6CH;iBAAA,2BACQ;UACR5C,gBAAa,KAAKA,UAAL,CAAgB,KAAKX,IAArB,KAA8B,EAAjD;UACI,KAAK+D,QAAT,EAAmB;eACVpD,aAAP;;aAEKA,cAAWd,MAAX,KAAsB,CAAtB,GAA0B,EAA1B,GAA+B,CAACc,cAAWA,cAAWd,MAAX,GAAoB,CAA/B,CAAD,CAAtC;KANM;cAAA,wBAQK;aACJa,kBAAkB,KAAKsD,aAAvB,EAAsC,KAAKpD,SAA3C,CAAP;KATM;iBAAA,2BAWQ;aACPH,OAAOwB,IAAP,CAAY,KAAKvC,UAAjB,EAA6BG,MAA7B,GAAsC,CAA7C;KAZM;kBAAA,4BAcS;aACR,CAAC,CAAC,KAAK8D,UAAd;KAfM;kBAAA,4BAiBS;UACTM,IAAI,KAAKN,UAAf;UACMvD,OAAO,EAAb;;;;;UAME,KAAKwD,WAAL,IACCM,QAAO,KAAKP,UAAZ,MAA2B,QAA3B,IAAuC,CAAC,KAAKA,UAAL,CAAgBQ,MAF3D,EAGE;aACKC,KAAL,GAAa,EAAEpE,MAAM,+BAAR,EAAb;eACOI,IAAP;;;UAGE,OAAO6D,CAAP,KAAa,QAAjB,EAA2B;aACpBG,KAAL,GAAa,EAAEpE,MAAMiE,CAAR,EAAb;OADF,MAEO,IAAI,QAAOA,CAAP,yCAAOA,CAAP,OAAa,QAAjB,EAA2B;aAC3BG,KAAL,GAAaH,CAAb;;UAEE,KAAKI,UAAT,EAAqB;aACdD,KAAL,CAAWE,GAAX,GAAiB,KAAKA,GAAtB;;WAEGC,EAAL,GAAU,KAAKC,gBAAf;;aAEOpE,IAAP;KA1CM;sBAAA,gCA4Ca;aACZ,KAAK4D,aAAL,CACJxE,GADI,CACA;eAAauB,UAAUZ,KAAvB;OADA,EAEJU,MAFI,CAEG,UAACM,KAAD,EAAQsD,QAAR;eAAqBtD,MAAMF,MAAN,CAAawD,QAAb,CAArB;OAFH,EAEgD,EAFhD,CAAP;;;GA1FS;;WAiGJ;cAAA,sBACInC,aADJ,EACmBoC,aADnB,EACkC;UACnC,KAAKX,QAAT,EAAmB;aACZY,KAAL,CAAW,QAAX,8BAAyBrC,aAAzB,gCAA6CoC,aAA7C;OADF,MAEO;YACCE,eACJtC,cAAczC,MAAd,KAAyB,CAAzB,GAA6BkD,SAA7B,GAAyCT,cAAc,CAAd,CAD3C;YAEMuC,eACJH,cAAc7E,MAAd,KAAyB,CAAzB,GAA6BkD,SAA7B,GAAyC2B,cAAc,CAAd,CAD3C;aAEKC,KAAL,CAAW,QAAX,eAA0BC,YAA1B,gBAA+CC,YAA/C;;KATG;;;YAAA,sBAaI;aACF,KAAK/D,UAAL,CAAgBjB,MAAhB,KAA2B,CAA3B,GACH,KAAKiB,UADF,GAEH,KAAKgE,MAAL,CAAY5B,OAAZ,IAAuB,EAF3B;KAdK;aAAA,uBAkBK;UACJ6B,YAAY,CAAC,KAAKtF,aAAN,IAAuB,KAAKuF,IAA9C;UACID,aAAa,KAAKE,QAAL,GAAgBpF,MAAhB,GAAyB,CAA1C,EAA6C;gBACnCqF,IAAR,CACE,qFADF;;aAIKH,SAAP;;GA1HS;QAAA,kBA6HNI,CA7HM,EA6HH;SACHtB,QAAL,CAAcC,QAAd,GAAyB,IAAzB;QACMiB,YAAY,KAAKA,SAAL,EAAlB;QACME,WAAW,KAAKA,QAAL,EAAjB;QACMG,iBAAiBL,YAAY,YAAZ,GAA2B,kBAAlD;QACMM,MAAM,KAAKf,GAAjB;;QAEI,KAAKgB,cAAT,EAAyB;aAErB;sBAAA;qCAAoB,KAAKC,cAAzB,IAAyC,SAAM,mBAA/C;SACGN,QADH;OADF;;;WAOKF,YACLE,SAAS,CAAT,CADK,GAGL;SAAA;;wCAC8B,KAAKO,kBAAL,CAAwBC,IAAxB,CAA6B,GAA7B;SACxB,KAAK/F,UAFX;OAIGuF,QAJH;KAHF;;CA5IJ;;ACCA,IAAMS,YAAY,OAAOC,MAAP,KAAkB,WAApC;;AAEA,IAAIC,MAAM,CAAV;;AAEA,aAAe;YACH,KADG;QAEP,QAFO;SAGN;;cAEK,EAAE3C,MAAME,OAAR,EAAiBD,SAAS,KAA1B,EAFL;UAGC,EAAED,MAAMG,MAAR,EAAgBF,SAAS;eAAME,OAAOwC,KAAP,CAAN;OAAzB,EAHD;WAIE,EAAE3C,MAAM4C,MAAR,EAAgB3C,SAAS,CAAzB,EAJF;UAKC,EAAED,MAAME,OAAR,EAAiBD,SAAS,KAA1B,EALD;eAMM,EAAED,MAAMxC,MAAR,EAAgByC,SAAS;eAAO,EAAP;OAAzB,EANN;SAOA,EAAED,MAAM,CAACG,MAAD,CAAR,EAAkBF,SAAS,KAA3B,EAPA;cAQK,EAAED,MAAMyC,YAAY,CAACtC,MAAD,EAAS0C,WAAT,CAAZ,GAAoC1C,MAA5C,EARL;iBASQ,EAAEH,MAAMG,MAAR,EATR;QAUD;YACIA,MADJ;eAEO;eAAMA,OAAO2C,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,QAA3B,CAAP,CAAN;;;GAfA;;SAAA,qBAmBH;QACJ,KAAKC,QAAT,EAAmB;WACZC,aAAL;;QAEE,CAAC,KAAKC,QAAV,EAAoB;WACbC,UAAL;;;;QAIE,KAAKxC,QAAL,CAAcC,QAAlB,EAA4B;WACrBD,QAAL,CAAcC,QAAd,GAAyB,KAAzB;;GA7BS;SAAA,qBAiCH;QACJ,KAAKsC,QAAT,EAAmB;WACZE,KAAL;KADF,MAEO;WACAD,UAAL;;;;QAIE,KAAKxC,QAAL,CAAcC,QAAlB,EAA4B;WACrBD,QAAL,CAAcC,QAAd,GAAyB,KAAzB;;GA1CS;eAAA,2BA8CG;SACTwC,KAAL;QACI,KAAKC,WAAT,EAAsB;WACfA,WAAL,CAAiBC,QAAjB;;GAjDS;;SAoDN;MAAA,cACFC,QADE,EACQC,QADR,EACkB;kBACTA,aAAaD,QAAzB,IAAqC,KAAKH,KAAL,CAAWI,QAAX,CAArC;WACKL,UAAL;KAHG;YAAA,oBAKII,QALJ,EAKcC,QALd,EAKwB;UACvBD,QAAJ,EAAc;aACPN,aAAL;;;GA3DO;;WAgEJ;mBAAA,6BACW;aACT,KAAKQ,YAAL,CAAkBzD,OAAlB,GACH,CAAC,KAAKyD,YAAL,CAAkBzD,OAAnB,CADG,GAEH,KAAK4B,MAAL,CAAY5B,OAFhB;KAFK;cAAA,wBAMM;UACL0D,cAAc,KAAKC,eAAL,EAApB;;UAEID,WAAJ,EAAiB;iBACNE,IAAT,CAAc;gBACN,KAAK9G,IADC;cAER,KAAK+B,EAFG;kDAGI6E,WAAhB,EAHY;iBAIL,KAAKG,WAAL,IAAoB,KAAKA,WAAL,CAAiBC,KAAjB,CAAuB,GAAvB,CAJf;iBAKL,KAAKvE;SALd;OADF,MAQO;aACA6D,KAAL;;KAlBG;SAAA,iBAsBDW,MAtBC,EAsBO;eACHC,KAAT,CAAe;cACP,KAAKlH,IADE;YAETiH,UAAU,KAAKlF;OAFrB;KAvBK;iBAAA,2BA6BS;UACVxC,WAAJ;UACM0H,SAAS,KAAKf,QAApB;;UAEI,OAAOe,MAAP,KAAkB,QAAtB,EAAgC;aACzBE,SAASC,aAAT,CAAuBH,MAAvB,CAAL;OADF,MAEO,IAAIA,kBAAkBnB,WAAtB,EAAmC;aACnCmB,MAAL;OADK,MAEA;gBACG/B,IAAR,CACE,uEADF;;;;UAME3F,EAAJ,EAAQ;YACA8H,YAAY,IAAIxF,GAAJ,cACbyF,YADa;kBAER,IAFQ;qBAGL;kBACH,KAAKvF,EADF;iBAEJxC,GAAGgI,OAFC;wBAGGjI,kBAAkBC,EAAlB;;WANhB;kBASUiI,MAAV,CAAiBjI,EAAjB;aACKgH,WAAL,GAAmBc,SAAnB;OAXF,MAYO;gBACGnC,IAAR,CACE,0CAA0C+B,MAA1C,GAAmD,gBADrD;;KAzDG;qBAAA,6BA8DWhC,QA9DX,EA8DqB;aACnB,OAAOA,QAAP,KAAoB,UAApB,GACHA,SAAS,KAAKrE,SAAd,CADG,GAEHqE,QAFJ;;GA/HS;;QAAA,kBAqINE,CArIM,EAqIH;QACFF,WAAW,KAAKH,MAAL,CAAY5B,OAAZ,IAAuB,KAAKyD,YAAL,CAAkBzD,OAAzC,IAAoD,EAArE;QACMmC,MAAM,KAAKf,GAAjB;QACIW,SAASpF,MAAT,IAAmB,KAAKuG,QAA5B,EAAsC;;WAE/BvC,QAAL,CAAcC,QAAd,GAAyB,IAAzB;aACOmB,SAASpF,MAAT,IAAmB,CAAnB,IAAwB,KAAKmF,IAA7B,GACLC,SAAS,CAAT,CADK,GAGL,EAAC,GAAD,GAAM,KAAKwC,iBAAL,CAAuBxC,QAAvB,CAAN,EAHF;KAHF,MAQO;aAEH,EAAC,GAAD;iBACS,UADT;eAES,eAFT;aAGO;QAJT;;;;CAjJN;;ACLA,SAASyC,OAAT,CAAiB7F,MAAjB,EAAiC;MAAX8F,IAAW,uEAAJ,EAAI;;SAC3BC,SAAJ,CAAcD,KAAKE,UAAL,IAAmB,QAAjC,EAA2CC,MAA3C;SACIF,SAAJ,CAAcD,KAAKI,gBAAL,IAAyB,cAAvC,EAAuDC,YAAvD;;AAEF,IAAI,OAAOrC,MAAP,KAAkB,WAAlB,IAAiCA,OAAO9D,GAA5C,EAAiD;SACxCA,GAAP,CAAWoG,GAAX,CAAe,EAAEP,SAASA,OAAX,EAAf;;;AAGF,YAAe;kBAAA;gBAAA;4BAAA;;CAAf;;;;;;;;"}